## 数据库设计和 E-R 模型

### 1. 设计阶段

- **刻画用户数据需求**：同专家用户进行交流，产品时用户需求规格说明书
- **概念设计（conceptual-design）** ：选择数据模型，并采用所选数据模型的概念将这些需求转化为数据库的概念
- **功能需求规格说明（specification of functional requirement）** ：用户描述将在数据上进行的各类操作（或事务），如修改数据，删除数据等
- **逻辑设计阶段（logical-design phase）** ：将高层的概念模式映射到将使用的数据库系统的实现数据模型上。通常包括将 E-R 模型定义的概念映射到关系模式
- **物理设计阶段（physical-design phase）**：指明数据库物理特征，包括文件组织格式和索引结构等

### 2. 实体 - 联系模型

实体 - 联系（entity-relationship，E-R）数据模型定义了三个基本概念：实体集、联系集和属性。

#### 2.1 实体集

**实体（entity）**是所有可以明确识别的个体。**实体集（entity set）**是相同类型具有相同性质或属性的一个实体集合。

实体通过一组属性来表示，属性是实体集中每个成员所拥有的描述性性质。每个属性具有一个值。

如 instructor 是一个实体集，一个特定的 instructor 实体拥有 salary 属性，该属性的值可能为 10000.

#### 2.2 联系集

**联系（relationship）**是指多个实体间的相互关联。**联系集（relationship set）**是相同类型联系的集合。

实体集之间的关联称为参与，即实体集 E~1~，E~2~ …… E~n~**参与（participate）**联系集 R。

n 个实体集之间的联系集称为 n 元联系集，例如两个实体集间的联系称为二元联系集。参与联系集的数目称为联系集的度，二元联系集的度为 2。

#### 2.3 属性

- **简单属性**：不可再分割为更小的部分的属性，如 ID
- **复合属性**：可以分割为更小的部分的属性，如 address 可分为 country、city 等
- **单值属性**：对某个特定实体只有一个取值，如 ID
- **多值属性**：某个特定实体集可能拥有多个取值的属性，如 phone_number
- **派生属性**：这类属性的值可以从别的相关属性或者实体中派生出来

### 3. 约束

#### 3.1 映射基数

- 一对一
- 一对多
- 多对一
- 多对多

#### 3.2 参与约束

如果实体集 E 中的每个实体都参与到联系集 R 的至少一个联系中，实体集 E 在联系集 R 中的参与称为**全部的**。

如果 E 中只有部分实体参与到 R 的联系集中，实体集 E 到联系集 R 的参与称为**部分的**。

### 4. E-R 图

E-R 图包含如下几个主要构件：

- 分成两部分的矩形代表实体集
- 菱形代表联系集
- 未分割的矩形代表联系集的属性。构成主码的属性以下划线标明
- 线段将实体集连接到联系集
- 虚线将联系集属性连接到联系集
- 双线显示实体在联系集中的参与度
- 双菱形代表连接到弱实体集的标志性联系集

描述映射基数在 E-R 图上的体现时，采用不同的箭头和线段：

- 一对一：从联系集到实体集各画一个箭头
- 一对多 / 多对一：从联系集向“一”的那边画一个箭头，“多”的那边画一条线段
- 多对多：从实体集到联系集全部画为线段

