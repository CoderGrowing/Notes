### 1. 对象的内存布局

在HotSpot虚拟机中，对象在内存中存储的布局可以分为3块区域：对象头（Header）、实例数据（Instance Data）和对齐填充（Padding）。

**对象头**

HotSpot虚拟机的对象头包括两部分信息，第一部分用于存储对象自身的运行时数据，如哈希码、GC分代年龄、锁状态标志、线程持有的锁、偏向线程ID、偏向时间戳等。

对象头的另一部分是类型指针。虚拟机通过这个指针来确定这个对象是哪个类的实例。如果对象是一个Java数组，那在对象头中还必须有一块用于记录数组长度的数据。

**实例数据**

实例数据部分是对象真正存储的有效信息，也是在程序代码中定义的各种类型的字段内容。

**对齐填充**

对齐填充并不是必然存在的，也无特殊意义，仅仅起到占位符的作用。

### 2. 对象的访问定位

Java程序需要通过栈上的reference数据来操作堆上的具体对象。reference类型在Java虚拟机规范中只规定了一个指向对象的引用，并没有定义如何去定位。所以具体实现方式由虚拟机来决定。目前主流的方式有**使用句柄**和**直接句柄**两种。

#### 2.1 使用句柄

使用句柄方式访问的话，Java堆会划分出一块内存来作为句柄池，reference中存储的就是对象的句柄地址，而句柄中包含了对象实例数据与类型数据各自具体的地址信息。

#### 2.2 直接访问

