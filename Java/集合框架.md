# 集合框架

Java中的集合是能够存放其他对象的一种对象，它相当于一个容器，提供了保存、删除、修改其中元素的方法。

集合框架最长用的接口是Collection接口，它允许对象容纳其他对象。还有Iterator和Comparator接口，分别让对象变得可迭代和可比较。还有一个Map接口，可以用来保存键值对。

## 1. Collection接口

**Collection接口允许对象集中存放在一起**。它提供了很多有用的方法，例如：

- `add()`：添加元素
- `addAll()`：添加另一个Collection的所有成员
- `clear()`：删除所有元素
- `size()`：返回元素数量
- `isEmpty()`：测试该集合是否包含元素

### 1.1 ArrayList

List是Collection中最常用的子接口，而ArrayList是List最常用的实现。

- 构造器：默认的无参构造器初始容量为10，随着元素添加进去不断扩大。实现知道容量的话可以指定容量大小，`public ArrayList(int initialCapacity)`。注意创建ArrayList对象时通常是将ArrayList对象赋值给一个List引用变量：`List list = new ArrayList()`。
- 添加元素：除了直接添加外还可以指定索引，`public void add (int index, Object element)`。
- 修改元素：`public Object set(int index, Object element)`
- 删除：`public Object remove(int index)`

### 1.2 迭代Collection

迭代Collection有两种常用的方法：Iterator和for。Collection扩展了Iterable接口，它有一个iterator方法，iterator方法返回一个java.util.Iterator，可以用它来迭代Collection。

Iterator接口有下列方法：

- `hasNext`：有下一个元素就返回true
- `next`：返回下一个元素，没有的话抛出异常
- `remove`：删除指针所指的元素

下面示例如何使用Iterator迭代Collection：

```java
Iterator iterator = myList.iterator();

while(iterator.hasNext()) {
    String element = (String) iterator.next();
    System.out.println(element);
}
```

**for语句**

```java
for (Object o : myList) {
    System.out.println(o);
}
```



### 1.3 Set和HashSet

Set类似于List，但Set不允许重复。Set接口有三个具体类：散列类HashSet、链式散列集LinkedHashSet和树形集TreeSet。

#### 1.3.1 HashSet

HashSet类可以用来存储各不相同的任何元素。考虑到效率的因素，添加到HashSet中的对象必须以一种正确分散散列码的方式来实现hashCode方法。如果两个对象相等，则散列码必须相同。

实例化HashSet时可以使用无参构造方法，默认的HashSet大小为16，负载系数为0.75。负载系数指定了当集合多大时应该翻倍（大小16，系数0.75，则16 * 0.75 = 12，当元素达到12个时大小翻倍）。如果事先知道元素个数可以指定容量和负载系数。

```java

```

#### 1.3.2 LinkedHashSet

LinkedHashSet从HashSet继承，它用链表扩展了HashSet类，从而可以按照插入集合的顺序提取。构造方法类似于HashSet。

#### 1.3.3 TreeSet

TreeSet实现了SortedSet接口，SortedSet是Set的一个子接口。SortedSet接口保证了集合中的元素是有序的，而且还提供了`first()`和`last()`方法，分别返回第一个和最后一个元素。以及`headSet(toElement)`方法和`tailSet(fromElement)`方法返回集合中小于toElement和大于等于fromElement的那一部分。

另外，TreeSet还实现了NavigableSet接口，该接口是SortedSet的子接口。它提供了导航方法`lower(e)`、`floor(e)`、`ceiling(e)`和`higher(e)`分别返回小于、小于等于、大于或等于以及大于一个给定元素的元素。如果没有这样的元素，返回null。方法`pollFirst()`和`pollLast()`分别会删除并返回第一个、最后一个元素。

只要一个对象是可以比较的，就可以添加到TreeSet中来。

```java
import java.util.HashSet;
import java.util.Set;
import java.util.TreeSet;

public class TestTreeSet {
    public static void main(String[] args) {
        Set<String> set = new HashSet<>();

        set.add("London");
        set.add("Paris");
        set.add("New York");
        set.add("London");
        set.add("San Francisco");
        set.add("Beijing");

        TreeSet<String> treeSet = new TreeSet<>(set);
        System.out.println("Sorted tree set: " + treeSet);

        System.out.println("first: " + treeSet.first());
        System.out.println("last: " + treeSet.last());
        System.out.println("headSet(\"New York\"): " + treeSet.headSet("New York"));
        System.out.println("tailSet(\"New York\"): " + treeSet.tailSet("New York"));

        System.out.println("lower P: " + treeSet.lower("P"));      // 小于
        System.out.println("higher P: " + treeSet.higher("P"));     // 大于
        System.out.println("floor P: " + treeSet.floor("P"));      // 小于或等于
        System.out.println("ceiling P: " + treeSet.ceiling("P"));    // 大于或等于

        System.out.println("pollFirst " + treeSet.pollFirst());
        System.out.println("pollLast: " + treeSet.pollLast());
    }
}
```

#### 1.4 Queue和LinkedList

LinkedList是Queue的一种实现。Queue支持FIFO（先进先出）的原则。常用方法如下：

- offer：类似add方法，但它在添加元素有可能失败时调用。若添加失败，返回false，add添加失败时则返回异常。
- remove：删除并返回Queue最前端的那个元素，若Queue为空时抛出异常
- poll：同remove，但Queue为空时返回null
- element：返回但不删除Queue最前端的元素，若Queue为空抛出异常
- peek：同element，但Queue为空时它返回null

### 2. Map接口

Map是保存键/值对的地方，键不允许重复，每个键只能映射到一个值。Map的常用实现有三种：散列映射表HashMap、链式散列映射表LinkedHashMap和树形散列表TreeMap。它们的结构和Set的三种实现类似。

- 添加一个键值对：`public void put (Object key, Object value)`。需要注意的是，键和值都不能是基本类型，但类似`put(1, 100)`这样的调用是合法的。因为在调用之前进行了自动装箱。
- 添加一个Map：`public putAll(Map map)`。
- 删除所有键和值：clear方法
- 键值数量：size方法
- 是否为空：isEmpty方法
- 取一个值：get(key)
- 获取所有键：keySet()方法，返回一个Set类型
- 获取所有值：values()方法，返回一个Collection
- 是否包含一个键：containsKey(Object key)
- 是否包含一个值：containsValue(Object value)

HashMap是没有顺序的，而LinkedHashMap

```java
import java.util.HashMap;
import java.util.Map;

public class TestMap {
    public static void main(String[] args) {
        Map<String, Integer> hashMap = new HashMap<>();

        hashMap.put("Smith", 30);
        hashMap.put("Lin", 25);
        hashMap.put("Tom", 28);

        System.out.println(hashMap);
        System.out.println("The age of Tom is: " + hashMap.get("Tom"));
    }
}
```



### 3. 对象比较和排序

java.util.Arrays类提供了sort方法，可以对任意的对象数组进行排序：`public static void sort (Object[] a)`。sort方法排序的依据是对象的`compareTo`方法，该方法是Comparable接口定义的方法，任何想要排序的对象都必须实现该方法。

`public int compareTo(Object obj)`该方法的参数是与当前对象比较的对象，若当前对象大于参数对象，返回一个正值，相等返回0，小于则返回一个负值。

```java
public class Elephant implements Comparable {
    public float weight;
    public int age;
    public float tuskLength;
    
    public int comparTo(Object obj) {
        Elephant anotherElephant = (Elephant) obj;
        if (this.weight > anotherElephant.weight)
            return 1;
        else if (this.weight < anotherElephant.weight)
            return -1;
        else
            return (this.age - anotherElephant.age); // 体重相等就比较年龄
    }
}
```

**Comparable和Comparator**

