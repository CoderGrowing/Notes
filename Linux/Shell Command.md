## 1. 权限相关

### 1.1 chown: 更改文件所有者(change owner)

- chown user.group file 可直接修改用户和组
- chown .group file 只修改组

### 1.2 chgrp: 更改所属用户组(change group)

### 1.3 chmod: 更改文件权限

- 数字方式：chmod 777 filename
- 权限方式：chmod u+x filename

使用权限方式时可用内容：

用户身份：

- u：user，用户
- g：group，用户组
- o：others，其他
- a：all，所有

设置内容

- +：加上
- -：除去
- =：设置为

如修改所有人权限为只读：chmod a=r filename

以上三个命令都有一个可选参数：R，使用-R参数可以递归的更改该目录下所有文件和目录的权限。

**注意对于目录而言，拥有r权限可以列出目录下的内容，拥有x权限才可进入目录。**

### 1.4 umask: 文件默认权限

umask指定目前用户在新建文件或者目录时候的权限默认值。

默认的umask值为：0022。那这四个数字什么意思呢？先来看后三个数字，后三个数字和普通的rwx权限有关，只不过这里的数字表示的是**该成员被减去的权限的值**。

0表示没有被减去权限，对文件而言默认权限值就是6，即rw，文件夹则为7，rwx。

2表示被减去了w权限。

022表示默认的权限值为：rw-r--r--（文件）、rwxr-xr-x（文件夹）。

#### 1.4.1 SUID,SGID,SBIT

那umask中第一个数字表示什么含义呢？它和文件/目录的特殊权限有关。

先来看一下/tmp目录和/usr/bin/passwd文件的奇怪权限：

```shell
ls -ld /tmp
# drwxrwxrwt 0 root root 512 Mar  5 16:25 /tmp/

ls -l /usr/bin/passwd
# -rwsr-xr-x 1 root root 54256 May 17  2017 /usr/bin/passwd*
```

那个s和t是什么意思呢？

**SUID**

当s出现在文件所有者的x权限上时，被称为Set UID，简称SUID的特殊权限。作用如下：

- SUID仅对二进制程序有效
- 执行者对本程序需要有x的权限
- 本权限仅在执行该程序的过程中有效
- 执行者将具有该程序所有者的权限

拿/etc/shadow来说，它的所有者是root，其他用户无权查看和修改。那普通用户怎么修改密码呢？就是靠SUID提供的特权啦，运行/usr/bin/passwd程序时用户将暂时拥有root的权限，从而更改自己的密码。

**SGID**

当s标志出现在用户组的x时被称为Set GID，SGID。作用类似于SUID，用户可暂时获得该程序组的支持。与SUID不同的是，SGID可以用在目录上，功能如下：

- 用户若对此目录具有r和x的权限，该用户可以进入此目录
- 用户在此目录下的有效用户组变为该目录的用户组
- 若用户在此目录下拥有w权限，则新建文件的用户组与此目录用户组相同

**SBIT**

Sticky Bit（SBIT)只对目录有效。作用如下：

- 当用户对此目录有w和x权限时，仅有自己和root可删除自己的创建的文件

例如/tmp，每个人均可访问此目录、创建文件，但创建的文件仅有自己和root可修改。

#### 1.4.2 SUID/SGID/SBIT权限设置

了解了这三个特殊权限的功能，那么如何配置这几个特殊权限呢？同样可采取数字和符号两种方式设置。

数字方式：

- SUID：4
- SGID：2
- SBIT：1

数字直接加在原来三位权限数字的前面即可，如"chmod 4755 filename"。

符号方式：

- SUID：u+s
- SGID：g+s
- SBIT：o+t

## 2. 文件与目录管理

### 2.1 cd：在目录间跳转

- cd ~：跳转至当前用户主目录
- cd ~username：跳转至username的用户主目录
- cd -：跳转至上一个工作目录

### 2.2 pwd：打印当前目录

```shell
pwd
# /home/username
```

### 2.3 ls：列出目录下文件信息

参数：

-l：

### 2.4 mkdir：新建文件夹

### 2.5 rmdir：删除文件夹

### 2.6 rm：删除文件

### 2.7 mv：移动文件

### 2.8 cp：复制文件

参数：

-a：相当于-pdr

-d：若源文件为连接文件的属性(link file)，则复制文件属性而非文件本身

-f：force，若文件已经存在且无法开启，则删除后再尝试一次

-i：若目标文件已经存在，覆盖时会先询问再进行

-l：进行硬连接(hard link)的连接文件创建

-p：连同文件的属性一同复制过去，而非使用默认属性(常用来备份)

-r：递归复制

-s：复制成为符号连接文件，即快捷方式

-u：若destination比source新才更新destination

### 2.9 touch：修改文件时间或者创建新文件

Linux下有三个主要的变动时间：

- modification time(mtime)：文件内容的修改时间
- status time(stime)：文件权限或者属性的修改时间
- access time(atime)：文件访问时间

默认情况下ls命令查看的是文件的mtime，当然我们也可以查看其它两个时间，使用`--time=ctime`或者`--time=atime`即可，如`ls -l --time=ctime /etc`。

用`touch`命令可以更改文件的时间。

参数：

-a：仅修改访问时间

-c：仅修改文件的时间，若文件不存在则创建文件

-d：后面接欲修改的日期而不是使用当前日期

-m：仅修改mtime

-t：后面接欲修改的时间而不是使用当前时间，格式为[YYMMDDhhmm]

### 2.10 chattr，lsattr：文件的隐藏属性

#### 2.10.1 chattr用来设置文件的隐藏属性。

**参数：**

+：增加一个特殊属性

-：删除一个特殊属性

=：仅有后面接的属性

A：访问文件或目录时访问atime不会被修改

S：文件修改同步写入磁盘

**a：该文件只能增加数据，不能修改也不能删除数据（仅root可设置）**

c：自动将文件压缩，读取时再解压缩。存储时先压缩再存储

d：dump程序执行时文件不会被备份

**i：为文件设置无法更改、删除、设置连接属性（仅root可设置）**

s：文件被删除时永远被磁盘删除

u：与s相反，可找回文件

```shell
touch test
sudo chattr +i test (设置i属性)
```

#### 2.10.2 lsattr用来显示文件隐藏属性

**参数：**

-a：将隐藏文件的属性也显示出来

-d：若接的是目录，则仅列出目录本身的属性而非目录内的文件名

-R：递归将子目录的数据也一并列出来

## 3. 磁盘管理

### 3.1 磁盘与目录的容量：df, du

df：列出文件系统的整体磁盘使用量

du：评估文件系统的磁盘使用量

#### 3.1.1 df

参数：

-a：列出所有的文件系统，包括系统特有的/proc等文件系统

-k：以KB的容量显示各文件系统

-m：以MB的容量显示各文件系统

-h：以人们较易阅读的GB、MB、KB等格式自行显示

-H：以M=1000K代替M=1024K的格式显示

-i：不用硬盘容量，而用inode的数量来显示

-T：连通该分区的文件系统名称（如ext4）也显示出来

#### 3.1.2 du

参数：

-a：列出所有的文件与目录容量（默认仅统计目录下的文件量而已）

-h：以人们易读的形式显示

-s：列出总量，不列出个别目录的量

-S：不包括子目录的总计

-k、-m：同df

### 3.2 连接文件：ln

#### 3.2.1硬连接（hard link）

创建硬连接其实相当于创建一个新文件，该文件连接到源文件的inode记录号码。所以硬连接文件和源文件拥有相同的属性信息，区别只在于文件名不同。如果删除连接文件，inode号码仍在存在，所以文件仍然可用。

硬连接文件几乎不占用硬盘空间。

硬连接的限制：

- 不能跨文件系统
- 不能连接到目录

#### 3.2.2 符号连接（symbol link）

符号连接类似于Windows下的快捷方式，它的文件数据只是指向了源文件的文件名而已。所以当源文件删除后，符号连接文件不可用。

用指令ln可以创建连接文件。

参数：

无参：创建硬连接

-s：创建符号连接

-f：如果目标文件存在时，就将目标文件删除后再进行



